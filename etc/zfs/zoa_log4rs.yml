#
# log4rs configuration file for ZFS Object Agent
#

# Scan this file for changes every 60 seconds
refresh_rate: 60 seconds

appenders:
  # An appender that sends errors to console
  stdout:
    kind: console
    filters:
    - kind: threshold
      level: off

  tracelog:
    kind: rolling_file
    path: "/var/log/zoa/trace.log"
    encoder:
      pattern: "[{d(%Y-%m-%d %H:%M:%S%.3f)}][{t}][{l}] {m}{n}"
    policy:
      kind: compound
      trigger:
        kind: size
        limit: 10mb
      roller:
        kind: fixed_window
        base: 1
        count: 150
        pattern: "/var/log/zoa/trace.log.{}"
    filters:
    - kind: threshold
      level: trace

  debuglog:
    kind: rolling_file
    path: "/var/log/zoa/debug.log"
    encoder:
      pattern: "[{d(%Y-%m-%d %H:%M:%S%.3f)}][{t}][{l}] {m}{n}"
    policy:
      kind: compound
      trigger:
        kind: size
        limit: 10mb
      roller:
        kind: fixed_window
        base: 1
        count: 150
        pattern: "/var/log/zoa/debug.log.{}"
    filters:
    - kind: threshold
      level: debug

  infolog:
    kind: rolling_file
    path: "/var/log/zoa/info.log"
    encoder:
      pattern: "[{d(%Y-%m-%d %H:%M:%S%.3f)}][{t}][{l}] {m}{n}"
    policy:
      kind: compound
      trigger:
        kind: size
        limit: 10mb
      roller:
        kind: fixed_window
        base: 1
        count: 100
        pattern: "/var/log/zoa/info.log.{}"
    filters:
    - kind: threshold
      level: info

  errorlog:
    kind: rolling_file
    path: "/var/log/zoa/error.log"
    encoder:
      pattern: "[{d(%Y-%m-%d %H:%M:%S%.3f)}][{t}][{l}] {m}{n}"
    policy:
      kind: compound
      trigger:
        kind: size
        limit: 10mb
      roller:
        kind: fixed_window
        base: 1
        count: 50
        pattern: "/var/log/zoa/error.log.{}"
    filters:
    - kind: threshold
      level: error

  memory:
    kind: buffer
    filters:
    - kind: threshold
      level: trace

# Set the default logging level to "trace" to permit trace logs to "memory".
# But tracelog is not enabled by default.
root:
  level: trace
  appenders:
    - stdout
#   - tracelog
    - debuglog
    - infolog
    - errorlog
    - memory

loggers:
  # These are too chatty; increase their log level
  rusoto_core::request:
    level: info
  want:
    level: debug
  azure_storage::core:
    level: info
  azure_storage_blobs::blob:
    level: info
  serde_xml_rs::de:
    level: info
  reqwest::async_impl::client:
    level: info
